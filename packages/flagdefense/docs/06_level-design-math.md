# レベルデザイン数学モデル

## 基本設計思想
- 各Waveで獲得可能なコインの理論値を算出
- そのコインで購入可能な最適火力を計算
- 敵のHPは理論火力の60-80%で撃破可能に設定（プレイヤーの戦略性を残す）

## 数式定義

### 1. Wave報酬計算
```
Wave報酬 = 基本敵報酬 × 敵数 + ボーナス報酬
基本敵報酬 = soldier(8) × 出現率 + tank(20) × 出現率 + jet(15) × 出現率 + ...
敵数 = min(25, wave + 4)
```

### 2. 累積コイン計算
```
累積コイン(wave) = 初期コイン + Σ(Wave報酬) + パッシブインカム累計
パッシブインカム累計 = 基本収入 × 経過時間 + ボーナス収入
```

### 3. 理論火力計算
```
理論火力 = 最適なタワー配置での総DPS
最適配置 = 累積コインで購入可能な最高効率の組み合わせ
効率 = DPS / コスト
```

### 4. 敵HP設定
```
基本HP = (理論火力 × 通過時間) × 難易度係数
難易度係数 = 0.6〜0.8（Wave進行で徐々に上昇）
通過時間 = パス長 / 敵速度
```

## Wave別詳細設計

### Wave 1-5（チュートリアル段階）
- 累積コイン: 80〜300
- 使用可能国家: Tier 1（20-50コスト）
- 理論火力: 3-15 DPS
- 敵HP: 5-20
- 難易度係数: 0.6

### Wave 6-10（基礎構築段階）
- 累積コイン: 300〜800
- 使用可能国家: Tier 1-2（20-150コスト）
- 理論火力: 20-50 DPS
- 敵HP: 15-40
- 難易度係数: 0.65

### Wave 11-15（中盤戦）
- 累積コイン: 800〜2000
- 使用可能国家: Tier 1-3（20-400コスト）
- 理論火力: 60-120 DPS
- 敵HP: 30-80
- 難易度係数: 0.7

### Wave 16-20（終盤戦）
- 累積コイン: 2000〜5000
- 使用可能国家: Tier 1-4（20-1100コスト）
- 理論火力: 150-300 DPS
- 敵HP: 60-150
- 難易度係数: 0.75

### Wave 21+（エンドゲーム）
- 累積コイン: 5000+
- 使用可能国家: 全Tier（20-4000コスト）
- 理論火力: 300+ DPS
- 敵HP: 100+
- 難易度係数: 0.8

## 敵タイプ別HP倍率

| 敵タイプ | HP倍率 | 速度 | 報酬倍率 |
|---------|--------|------|----------|
| soldier | 1.0x | 40 | 1.0x |
| jet | 0.8x | 80 | 1.2x |
| tank | 2.0x | 20 | 2.5x |
| elite | 3.0x | 30 | 4.0x |
| boss | 5.0x | 15 | 10.0x |

## 難易度調整パラメータ

### Easy
- コイン獲得: 1.5x
- 敵HP: 0.8x
- パッシブインカム: 2x

### Normal
- コイン獲得: 1.0x
- 敵HP: 1.0x
- パッシブインカム: 1x

### Hard
- コイン獲得: 0.8x
- 敵HP: 1.2x
- パッシブインカム: 0.5x

### ハードスキップ
- コイン獲得: 2.0x（一時的）
- 敵HP: 1.3x（その Wave のみ）

## 実装例

```javascript
// Wave5の場合
const wave = 5;
const enemyCount = Math.min(25, wave + 4); // 9体

// 累積報酬計算
const baseRewards = {
  soldier: 8,
  tank: 20,
  jet: 15
};

// Wave5までの累積コイン（概算）
const cumulativeCoins = 80 + (8 * 5 + 20 * 1) * 4; // 約240コイン

// 理論火力（最適配置）
// Tier1: liberland(20) x 3 = 9 DPS
// Tier1: transnistria(30) x 2 = 8 DPS
// Tier1: somaliland(40) x 2 = 10 DPS
// 合計: 27 DPS（コスト: 200）

// 敵HP設定
const pathTime = 10; // 秒（仮定）
const difficultyFactor = 0.6;
const baseHP = 27 * pathTime * difficultyFactor; // 162
const enemyHP = Math.floor(baseHP / enemyCount); // 約18 HP/体
```